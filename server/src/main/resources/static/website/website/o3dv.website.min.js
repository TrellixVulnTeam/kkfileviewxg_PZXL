OV.FeatureSet={ShowGrid:!1,MeasureTool:!1};OV.EventHandler=class{constructor(a){this.eventHandler=a}HandleEvent(a,b){void 0!==this.eventHandler&&null!==this.eventHandler&&this.eventHandler(a,b)}};OV.GetNameOrDefault=function(a,b){return 0<a.length?a:b};OV.GetNodeName=function(a){return OV.GetNameOrDefault(a,"No Name")};OV.GetMeshName=function(a){return OV.GetNameOrDefault(a,"No Name")};OV.GetMaterialName=function(a){return OV.GetNameOrDefault(a,"No Name")};OV.IsHoverEnabled=function(){return window.matchMedia("(hover: hover)").matches};OV.AddSmallWidthChangeEventListener=function(a){window.matchMedia("(max-width: 800px)").addEventListener("change",a)};OV.IsSmallWidth=function(){return window.matchMedia("(max-width: 800px)").matches};
OV.IsSmallHeight=function(){return window.matchMedia("(max-height: 800px)").matches};OV.InstallTooltip=function(a,b){if(OV.IsHoverEnabled()){var c=null;a.addEventListener("mouseover",()=>{var d=c=OV.AddDiv(document.body,"ov_tooltip",b);var e=window.innerWidth;let f=a.getBoundingClientRect(),g=a.offsetHeight,h=d.offsetWidth;d=f.left+a.offsetWidth/2-h/2;d+h>e-10&&(d=e-h-10);10>d&&(d=10);d=Math.max(d,0);e=f.top+g+10;c.style.left=d+"px";c.style.top=e+"px"});a.addEventListener("mouseout",()=>{c.remove()})}};
OV.CopyToClipboard=function(a){let b=document.createElement("input");b.style.position="absolute";b.style.left="0";b.style.top="0";b.setAttribute("value",a);document.body.appendChild(b);b.select();document.execCommand("copy");document.body.removeChild(b)};OV.DownloadUrlAsFile=function(a,b){let c=document.createElement("a");c.href=a;c.download=b;document.body.appendChild(c);c.click();document.body.removeChild(c)};
OV.DownloadArrayBufferAsFile=function(a,b){a=OV.CreateObjectUrl(a);OV.DownloadUrlAsFile(a,b)};OV.CreateSvgIconElement=function(a,b){let c=OV.CreateDiv("ov_svg_icon");b&&c.classList.add(b);OV.AddDomElement(c,"i","icon icon-"+a);return c};OV.AddSvgIconElement=function(a,b,c){b=OV.CreateSvgIconElement(b,c);a.appendChild(b);return b};OV.SetSvgIconImageElement=function(a,b){a.firstChild.className="icon icon-"+b};
OV.CreateHeaderButton=function(a,b,c,d){let e=OV.CreateDomElement("a");e.setAttribute("href",d);e.setAttribute("target","_blank");e.setAttribute("rel","noopener noreferrer");OV.InstallTooltip(e,c);OV.AddSvgIconElement(e,b,"header_button");a.appendChild(e);return e};
OV.CreateInlineColorCircle=function(a){let b="#"+OV.ColorToHexString(a);a=new OV.Color(Math.max(0,a.r-50),Math.max(0,a.g-50),Math.max(0,a.b-50));a="#"+OV.ColorToHexString(a);let c=OV.CreateDiv("ov_color_circle");c.style.background=b;c.style.border="1px solid "+a;return c};OV.InstallVerticalSplitter=function(a,b,c,d){let e=null;OV.CreateVerticalSplitter(a,{onSplitStart:()=>{e=OV.GetDomElementOuterWidth(b)},onSplit:f=>{f=c?e-f:e+f;280>f?f=280:450<f&&(f=450);OV.SetDomElementOuterWidth(b,f);d()}})};
OV.GetFilesFromDataTransfer=function(a,b){async function c(f,g){let h=f.createReader();return new Promise((l,n)=>{h.readEntries(async m=>{for(let k of m)k.isFile?g.push(k):k.isDirectory&&await c(k,g);l()},m=>{n(m)})})}async function d(f,g){let h=[];for(let l of f)l.isFile?h.push(l):l.isDirectory&&await c(l,h);f=await Promise.all(h.map(l=>new Promise((n,m)=>{l.file(k=>{n(k)},k=>{m(k)})})));g(f)}let e=null;DataTransferItem&&(DataTransferItem.prototype.getAsEntry?e=DataTransferItem.prototype.getAsEntry:
DataTransferItem.prototype.webkitGetAsEntry&&(e=DataTransferItem.prototype.webkitGetAsEntry));if(null!==e){let f=[];for(let g of a.items)f.push(e.call(g));d(f,g=>{b(g)})}else b(a.files)};OV.CookieHandler=class{constructor(){this.expirationDays=365}ClearVal(a){this.SetStringVal(a,"")}SetStringVal(a,b){let c=new Date;c.setTime(c.getTime()+864E5*this.expirationDays);document.cookie=a+"="+b+"; expires="+c.toUTCString()+";"}GetStringVal(a,b){let c=decodeURIComponent(document.cookie).split(";");for(let d=0;d<c.length;d++){let e=c[d].trim();if(e.startsWith(a+"="))return e.substr(a.length+1)}return b}GetBoolVal(a,b){a=this.GetStringVal(a,null);return null===a?b:"true"===a?!0:!1}SetBoolVal(a,
b){this.SetStringVal(a,b?"true":"false")}GetIntVal(a,b){a=this.GetStringVal(a,null);return null===a?b:parseInt(a,10)}SetIntVal(a,b){this.SetStringVal(a,b.toString())}GetColorVal(a,b){a=this.GetStringVal(a,null);return null===a?b:OV.ParameterConverter.StringToColor(a)}SetColorVal(a,b){this.SetStringVal(a,OV.ParameterConverter.ColorToString(b))}};OV.Theme={Light:1,Dark:2};
OV.Settings=class{constructor(){this.backgroundColor=new OV.Color(255,255,255);this.defaultColor=new OV.Color(200,200,200);this.showEdges=this.showGrid=!1;this.edgeColor=new OV.Color(0,0,0);this.edgeThreshold=1;this.themeId=OV.Theme.Light}LoadFromCookies(a){this.backgroundColor=a.GetColorVal("ov_background_color",new OV.Color(255,255,255));this.defaultColor=a.GetColorVal("ov_default_color",new OV.Color(200,200,200));this.showGrid=a.GetBoolVal("ov_show_grid",!1);this.showEdges=a.GetBoolVal("ov_show_edges",
!1);this.edgeColor=a.GetColorVal("ov_edge_color",new OV.Color(0,0,0));this.edgeThreshold=a.GetIntVal("ov_edge_threshold",1);this.showEdges=a.GetBoolVal("ov_show_edges",!1);this.themeId=a.GetIntVal("ov_theme_id",OV.Theme.Light)}SaveToCookies(a){a.SetColorVal("ov_background_color",this.backgroundColor);a.SetColorVal("ov_default_color",this.defaultColor);a.SetBoolVal("ov_show_grid",this.showGrid);a.SetBoolVal("ov_show_edges",this.showEdges);a.SetColorVal("ov_edge_color",this.edgeColor);a.SetIntVal("ov_edge_threshold",
this.edgeThreshold);a.SetIntVal("ov_theme_id",this.themeId)}};OV.ToolbarButton=class{constructor(a,b,c){this.image=a;this.imageTitle=b;this.selected=!1;this.buttonDiv=OV.CreateDiv("ov_toolbar_button");this.buttonImg=OV.AddSvgIconElement(this.buttonDiv,this.image);null!==c&&this.buttonDiv.addEventListener("click",c);this.buttonDiv.setAttribute("alt",this.imageTitle);OV.InstallTooltip(this.buttonDiv,this.imageTitle)}AddDomElements(a){a.appendChild(this.buttonDiv)}AddClass(a){this.buttonDiv.classList.add(a)}RemoveClass(a){this.buttonDiv.classList.remove(a)}AddImageClass(a){this.buttonImg.classList.add(a)}RemoveImageClass(a){this.buttonImg.classList.remove(a)}IsSelected(){return this.selected}SetSelected(a){(this.selected=
a)?this.buttonDiv.classList.add("selected"):this.buttonDiv.classList.remove("selected")}};
OV.Toolbar=class{constructor(a){this.mainDiv=OV.AddDiv(a,"ov_toolbar")}AddImageButton(a,b,c){a=new OV.ToolbarButton(a,b,c);a.AddDomElements(this.mainDiv);return a}AddImagePushButton(a,b,c,d){let e=new OV.ToolbarButton(a,b,()=>{e.SetSelected(!e.IsSelected());d()});e.AddDomElements(this.mainDiv);e.SetSelected(c);return e}AddImageRadioButton(a,b,c){let d=[];for(let f=0;f<a.length;f++){var e=a[f];e=this.AddImageButton(e.image,e.title,()=>{for(let g=0;g<d.length;g++){let h=d[g];g===f?h.SetSelected(!0):
h.SetSelected(!1)}c(f)});b===f&&e.SetSelected(!0);d.push(e)}return d}AddSeparator(){return OV.AddDiv(this.mainDiv,"ov_toolbar_separator")}};OV.ScrollToView=function(a){a.scrollIntoView({behavior:"smooth",block:"nearest"})};OV.TreeViewButton=class{constructor(a){this.imagePath=a;this.mainElement=OV.CreateSvgIconElement(this.imagePath,"ov_tree_item_button");this.mainElement.setAttribute("src",this.imagePath)}SetImage(a){this.imagePath=a;OV.SetSvgIconImageElement(this.mainElement,this.imagePath)}OnClick(a){this.mainElement.addEventListener("click",b=>{b.stopPropagation();a(b)})}GetDomElement(){return this.mainElement}};
OV.TreeViewItem=class{constructor(a,b){this.name=a;this.parent=null;this.mainElement=OV.CreateDiv("ov_tree_item");this.mainElement.setAttribute("title",this.name);this.nameElement=OV.AddDiv(this.mainElement,"ov_tree_item_name",this.name);OV.IsDefined(b)&&(a=OV.CreateSvgIconElement(b,"ov_tree_item_icon"),OV.InsertDomElementBefore(a,this.nameElement))}OnClick(a){this.mainElement.classList.add("clickable");this.mainElement.style.cursor="pointer";this.mainElement.addEventListener("click",a)}SetParent(a){this.parent=
a}AddDomElements(a){a.appendChild(this.mainElement)}};OV.TreeViewSingleItem=class extends OV.TreeViewItem{constructor(a,b){super(a,b);this.selected=!1}SetSelected(a){if(this.selected=a)if(this.mainElement.classList.add("selected"),a=this.parent,null===a)OV.ScrollToView(this.mainElement);else for(;null!==a;)a.ShowChildren(!0),OV.ScrollToView(this.mainElement),a=a.parent;else this.mainElement.classList.remove("selected")}};
OV.TreeViewButtonItem=class extends OV.TreeViewSingleItem{constructor(a,b){super(a,b);this.buttonsDiv=OV.CreateDiv("ov_tree_item_button_container");OV.InsertDomElementBefore(this.buttonsDiv,this.nameElement)}AppendButton(a){this.buttonsDiv.appendChild(a.GetDomElement())}};
OV.TreeViewGroupItem=class extends OV.TreeViewItem{constructor(a,b){super(a,b);this.children=[];this.isVisible=!0;this.isChildrenVisible=!1;this.childrenDiv=null;this.openButtonIcon="arrow_down";this.closeButtonIcon="arrow_right";this.openCloseButton=OV.CreateSvgIconElement(this.openButtonIcon,"ov_tree_item_icon");OV.InsertDomElementBefore(this.openCloseButton,this.nameElement)}AddChild(a){this.CreateChildrenDiv();this.children.push(a);a.SetParent(this);a.AddDomElements(this.childrenDiv)}ExpandAll(a){for(let b of this.children)b instanceof
OV.TreeViewGroupItem&&(b.ShowChildren(a),b.ExpandAll(a))}Show(a){this.isVisible=a;null!==this.childrenDiv&&(this.isVisible?(OV.ShowDomElement(this.mainElement,!0),this.childrenDiv.classList.add("ov_tree_view_children")):(OV.ShowDomElement(this.mainElement,!1),this.childrenDiv.classList.remove("ov_tree_view_children")))}ShowChildren(a){this.isChildrenVisible=a;null!==this.childrenDiv&&(a?(OV.SetSvgIconImageElement(this.openCloseButton,this.openButtonIcon),OV.ShowDomElement(this.childrenDiv,!0)):(OV.SetSvgIconImageElement(this.openCloseButton,
this.closeButtonIcon),OV.ShowDomElement(this.childrenDiv,!1)))}CreateChildrenDiv(){null===this.childrenDiv&&(this.childrenDiv=OV.CreateDiv("ov_tree_view_children"),OV.InsertDomElementAfter(this.childrenDiv,this.mainElement),this.Show(this.isVisible),this.ShowChildren(this.isChildrenVisible),this.OnClick(a=>{this.isChildrenVisible=!this.isChildrenVisible;this.ShowChildren(this.isChildrenVisible)}));return this.childrenDiv}};
OV.TreeViewGroupButtonItem=class extends OV.TreeViewGroupItem{constructor(a,b){super(a,b);this.buttonsDiv=OV.CreateDiv("ov_tree_item_button_container");OV.InsertDomElementBefore(this.buttonsDiv,this.nameElement)}AppendButton(a){this.buttonsDiv.appendChild(a.GetDomElement())}};
OV.TreeView=class{constructor(a){this.mainDiv=OV.AddDiv(a,"ov_tree_view");this.children=[]}AddClass(a){this.mainDiv.classList.add(a)}AddChild(a){a.AddDomElements(this.mainDiv);this.children.push(a)}Clear(){OV.ClearDomElement(this.mainDiv);this.children=[]}};OV.CreateVerticalSplitter=function(a,b){let c=null,d=f=>{f.preventDefault();b.onSplit(f.clientX-c)},e=()=>{document.removeEventListener("mousemove",d);document.removeEventListener("mouseup",e);document.removeEventListener("mouseleave",e);c=null};a.addEventListener("mousedown",f=>{c=f.clientX;b.onSplitStart();document.addEventListener("mousemove",d);document.addEventListener("mouseup",e);document.addEventListener("mouseleave",e)})};OV.Modal=class{constructor(){this.modalDiv=OV.CreateDiv("ov_modal");this.closeHandler=this.positionCalculator=this.resizeHandler=this.overlayDiv=null;this.isOpen=!1;this.closeable=!0}GetContentDiv(){return this.modalDiv}SetCloseable(a){this.closeable=a}SetPositionCalculator(a){this.positionCalculator=a}SetCloseHandler(a){this.closeHandler=a}Open(){this.overlayDiv=OV.AddDiv(document.body,"ov_modal_overlay");document.body.appendChild(this.modalDiv);this.resizeHandler=this.Resize.bind(this);window.addEventListener("resize",
this.resizeHandler);this.closeable&&(this.overlayDiv.addEventListener("click",a=>{a.preventDefault();this.Close()}),this.overlayDiv.addEventListener("contextmenu",a=>{a.preventDefault();this.Close()}));this.isOpen=!0;this.Resize()}Close(){this.isOpen&&(window.removeEventListener("resize",this.resizeHandler),null!==this.closeHandler&&this.closeHandler(),this.modalDiv.remove(),this.overlayDiv.remove(),this.resizeHandler=this.overlayDiv=null,this.isOpen=!1)}IsOpen(){return this.isOpen}Resize(){let a=
(window.innerWidth-this.modalDiv.offsetWidth)/2;var b=(window.innerHeight-this.modalDiv.offsetHeight)/3;null!==this.positionCalculator&&(b=this.positionCalculator(),a=b.x,b=b.y);this.modalDiv.style.left=a+"px";this.modalDiv.style.top=b+"px"}};OV.Dialog=class{constructor(){this.modal=new OV.Modal}GetContentDiv(){return this.modal.GetContentDiv()}SetCloseable(a){this.modal.SetCloseable(a)}SetCloseHandler(a){this.modal.SetCloseHandler(a)}SetPositionCalculator(a){this.modal.SetPositionCalculator(a)}Show(){this.modal.Open()}Hide(){this.modal.Close()}};
OV.ProgressDialog=class extends OV.Dialog{constructor(){super();this.modal.SetCloseable(!1);this.textDiv=null}Init(a){let b=this.modal.GetContentDiv();b.classList.add("ov_progress");this.textDiv=OV.AddDiv(b,"ov_progress_text");this.SetText(a)}SetText(a){this.textDiv.innerHTML=a}};
OV.ButtonDialog=class extends OV.Dialog{constructor(){super()}Init(a,b){function c(e,f){f=OV.AddDiv(f,"ov_button ov_dialog_button",e.name);e.subClass&&f.classList.add(e.subClass);f.addEventListener("click",()=>{e.onClick()})}var d=this.modal.GetContentDiv();d.classList.add("ov_dialog");OV.AddDiv(d,"ov_dialog_title",a);a=OV.AddDiv(d,"ov_dialog_content");d=OV.AddDiv(d,"ov_dialog_buttons");d=OV.AddDiv(d,"ov_dialog_buttons_inner");for(let e=0;e<b.length;e++)c(b[e],d);return a}};
OV.PopupDialog=class extends OV.Dialog{constructor(){super()}Init(a){let b=this.modal.GetContentDiv();b.classList.add("ov_popup");this.modal.SetPositionCalculator(a);return b}};
OV.ListPopup=class extends OV.PopupDialog{constructor(){super();this.listDiv=null}Init(a){a=super.Init(a);this.listDiv=OV.AddDiv(a,"ov_popup_list ov_thin_scrollbar");return a}AddListItem(a,b){let c=OV.AddDiv(this.listDiv,"ov_popup_list_item");a.icon&&OV.AddSvgIconElement(c,a.icon,"left_inline");if(a.color){let d=OV.AddDiv(c,"ov_popup_list_item_icon"),e=OV.CreateInlineColorCircle(a.color);d.appendChild(e)}OV.AddDiv(c,"ov_popup_list_item_name",a.name);c.addEventListener("click",b.onClick);OV.IsHoverEnabled()&&
b.onHoverStart&&b.onHoverStop&&(c.addEventListener("mouseover",()=>{b.onHoverStart()}),c.addEventListener("mouseout",()=>{b.onHoverStop()}))}};OV.ShowMessageDialog=function(a,b,c){let d=new OV.ButtonDialog;a=d.Init(a,[{name:"OK",onClick(){d.Hide()}}]);OV.AddDiv(a,"ov_dialog_message",b);null!==c&&OV.AddDiv(a,"ov_dialog_submessage",c);d.Show();return d};
OV.ShowListPopup=function(a,b){if(0===a.length)return null;let c=new OV.ListPopup;c.Init(()=>b.calculatePosition(c.GetContentDiv()));for(let d=0;d<a.length;d++)c.AddListItem(a[d],{onHoverStart:function(){if(b.onHoverStart)b.onHoverStart(d)},onHoverStop:function(){if(b.onHoverStop)b.onHoverStop(d)},onClick:function(){c.Hide();b.onClick(d)}});c.Show();return c};
OV.CalculatePopupPositionToElementBottomRight=function(a,b){let c=a.getBoundingClientRect();return{x:c.left+a.offsetWidth,y:c.top+a.offsetHeight-b.offsetHeight}};OV.CalculatePopupPositionToScreen=function(a,b){let c=window.innerWidth,d=window.innerHeight,e=a.x;a=a.y;let f=e+b.offsetWidth;b=a+b.offsetHeight;f>c&&(e-=f-c);b>d&&(a-=b-d);return{x:e,y:a}};OV.ShowOpenUrlDialog=function(a){let b=new OV.ButtonDialog,c=OV.CreateDomElement("textarea","ov_dialog_textarea"),d=b.Init("Open Model from Url",[{name:"Cancel",subClass:"outline",onClick(){b.Hide()}},{name:"OK",onClick(){let e=[];OV.ReadLines(c.value,f=>{e.push(f)});b.Hide();a(e)}}]);OV.AddDiv(d,"ov_dialog_section","Here you can load models based on their urls. You can add more lines if your model builds up from multiple files.");d.appendChild(c);b.Show();c.focus();return b};OV.ExportType={Model:0,Image:1};OV.ExporterUI=class{constructor(a){this.name=a}GetType(){return null}GetName(){return this.name}GenerateParametersUI(a){}AddCheckbox(a,b,c,d){a=OV.AddDiv(a,"ov_dialog_row");return OV.AddCheckbox(a,b,c,d)}AddSelect(a,b,c,d){a=OV.AddDiv(a,"ov_dialog_row");OV.AddDiv(a,"ov_dialog_row_name",b);b=OV.AddDiv(a,"ov_dialog_row_value");return OV.AddSelect(b,c,d)}};
OV.ModelExporterUI=class extends OV.ExporterUI{constructor(a,b,c){super(a);this.format=b;this.extension=c;this.rotationSelect=this.visibleOnlySelect=null}GetType(){return OV.ExportType.Model}GenerateParametersUI(a){this.visibleOnlySelect=this.AddSelect(a,"Scope",["Entire Model","Visible Only"],1);this.rotationSelect=this.AddSelect(a,"Rotation",["No Rotation","-90 Degrees","90 Degrees"],0)}ExportModel(a,b){let c=new OV.ExporterSettings;1===this.visibleOnlySelect.selectedIndex&&(c.isMeshVisible=f=>
b.isMeshVisible(f));if(1===this.rotationSelect.selectedIndex){var d=(new OV.Matrix).CreateRotationAxisAngle(new OV.Coord3D(1,0,0),-Math.PI/2);c.transformation.SetMatrix(d)}else 2===this.rotationSelect.selectedIndex&&(d=(new OV.Matrix).CreateRotationAxisAngle(new OV.Coord3D(1,0,0),Math.PI/2),c.transformation.SetMatrix(d));if(0===(new OV.ExporterModel(a,c)).MeshInstanceCount())d=OV.ShowMessageDialog("Export Failed","The model doesn't contain any meshes.",null),b.onDialog(d);else{var e=new OV.ProgressDialog;
e.Init("Exporting Model");e.Show();OV.RunTaskAsync(()=>{(new OV.Exporter).Export(a,c,this.format,this.extension,{onError:()=>{e.Hide()},onSuccess:f=>{if(0===f.length)e.Hide();else if(1===f.length){e.Hide();let g=f[0];OV.DownloadArrayBufferAsFile(g.GetBufferContent(),g.GetName())}else 1<f.length&&OV.LoadExternalLibrary("loaders/fflate.min.js").then(()=>{var g={};for(let h of f)g[h.name]=new Uint8Array(h.content);g=fflate.zipSync(g).buffer;e.Hide();OV.DownloadArrayBufferAsFile(g,"model.zip")}).catch(()=>
{e.Hide()})}})})}}};
OV.ImageExporterUI=class extends OV.ExporterUI{constructor(a,b){super(a);this.extension=b;this.sizeSelect=null;this.sizes=[{name:"Current size",value:null},{name:"1280 x 720",value:[1280,720]},{name:"1920 x 1080",value:[1920,1080]}]}GetType(){return OV.ExportType.Image}GenerateParametersUI(a){let b=this.sizes.map(c=>c.name);this.sizeSelect=this.AddSelect(a,"Image size",b,1)}ExportImage(a){var b=this.sizes[this.sizeSelect.selectedIndex];null===b.value?(b=a.GetImageSize(),a=a.GetImageAsDataUrl(b.width,b.height)):
a=a.GetImageAsDataUrl(b.value[0],b.value[1]);OV.DownloadUrlAsFile(a,"model."+this.extension)}};
OV.ExportDialog=class{constructor(a,b){this.callbacks=a;this.eventHandler=b;this.parametersDiv=this.selectedExporter=null;this.exporters=[new OV.ModelExporterUI("Wavefront (.obj)",OV.FileFormat.Text,"obj"),new OV.ModelExporterUI("Stereolithography Text (.stl)",OV.FileFormat.Text,"stl"),new OV.ModelExporterUI("Stereolithography Binary (.stl)",OV.FileFormat.Binary,"stl"),new OV.ModelExporterUI("Polygon File Format Text (.ply)",OV.FileFormat.Text,"ply"),new OV.ModelExporterUI("Polygon File Format Binary (.ply)",
OV.FileFormat.Binary,"ply"),new OV.ModelExporterUI("glTF Text (.gltf)",OV.FileFormat.Text,"gltf"),new OV.ModelExporterUI("glTF Binary (.glb)",OV.FileFormat.Binary,"glb"),new OV.ModelExporterUI("Object File Format Text (.off)",OV.FileFormat.Text,"off"),new OV.ModelExporterUI("Rhinoceros 3D (.3dm)",OV.FileFormat.Binary,"3dm"),new OV.ImageExporterUI("PNG Image (.png)","png")]}Show(a,b){let c=new OV.ButtonDialog;var d=c.Init("Export",[{name:"Close",subClass:"outline",onClick(){c.Hide()}},{name:"Export",
onClick:()=>{c.Hide();this.ExportFormat(a,b)}}]);OV.AddDiv(d,"ov_dialog_section","Select the format from the list below, and adjust the settings of the selected format.");let e=OV.AddDiv(d,"ov_dialog_row");this.parametersDiv=OV.AddDiv(d);d=this.exporters.map(f=>f.GetName());OV.AddSelect(e,d,6,f=>{this.OnFormatSelected(f)});this.OnFormatSelected(6);c.Show();this.callbacks.onDialog(c)}OnFormatSelected(a){OV.ClearDomElement(this.parametersDiv);this.selectedExporter=this.exporters[a];this.selectedExporter.GenerateParametersUI(this.parametersDiv)}ExportFormat(a,
b){this.selectedExporter.GetType()===OV.ExportType.Model?(this.selectedExporter.ExportModel(a,{isMeshVisible:c=>this.callbacks.isMeshVisible(c),onDialog:c=>{this.callbacks.onDialog(c)}}),this.eventHandler.HandleEvent("model_exported",this.selectedExporter.GetName())):this.selectedExporter.GetType()===OV.ExportType.Image&&this.selectedExporter.ExportImage(b)}};OV.ShowSharingDialog=function(a,b,c,d){function e(k,p,q,r){k=OV.AddDiv(k,"ov_dialog_row");let u=OV.AddCheckbox(k,q,p,!0,()=>{r(u.checked)})}function f(k){let p=OV.CreateUrlBuilder();p.AddModelUrls(k.files);return"https://3dviewer.net#"+p.GetParameterList()}function g(k){let p=OV.CreateUrlBuilder();p.AddModelUrls(k.files);p.AddCamera(k.camera);p.AddBackgroundColor(k.backgroundColor);p.AddDefaultColor(k.defaultColor);p.AddEdgeSettings(k.edgeSettings);return'<iframe width="640" height="480" style="border:1px solid #eeeeee;" src="https://3dviewer.net/embed.html#'+
(p.GetParameterList()+'"></iframe>')}function h(k,p){k=OV.AddDiv(k,"ov_dialog_copyable_input");let q=OV.AddDomElement(k,"input","ov_dialog_text");q.readOnly=!0;let r=OV.AddDiv(k,"ov_button outline ov_dialog_copyable_input_button","Copy");r.addEventListener("click",()=>{OV.CopyToClipboard(p());r.innerHTML="Copied";setTimeout(()=>{r.innerHTML="Copy"},2E3)});return q}if(!a.IsOnlyUrlSource())return OV.ShowMessageDialog("Sharing Failed","Sharing works only if you load files by url. Please upload your model files to a web server, open them by url, and try embedding again.",
null);var l=a.GetFiles();a=[];for(var n=0;n<l.length;n++){let k=l[n];k.source===OV.FileSource.Url&&a.push(k.fileUrl)}l={files:a};a={files:a,camera:c,backgroundColor:b.backgroundColor,defaultColor:b.defaultColor,edgeSettings:{showEdges:b.showEdges,edgeColor:b.edgeColor,edgeThreshold:b.edgeThreshold}};let m=new OV.ButtonDialog;n=m.Init("Share",[{name:"Close",onClick(){m.Hide()}}]);(function(k,p,q){k=OV.AddDiv(k,"ov_dialog_section");OV.AddDiv(k,"ov_dialog_inner_title","Sharing Link");h(k,()=>{q.HandleEvent("model_shared",
"sharing_link");return f(p)}).value=f(p)})(n,l,d);(function(k,p,q,r){k=OV.AddDiv(k,"ov_dialog_section");k.style.marginTop="20px";OV.AddDiv(k,"ov_dialog_inner_title","Embedding Code");let u=OV.AddDiv(k,"ov_dialog_section"),v=h(k,()=>{r.HandleEvent("model_shared","embedding_code");return g(q)});e(u,"Use current camera position","embed_camera",t=>{q.camera=t?c:null;v.value=g(q)});e(u,"Use overridden background color","embed_background",t=>{q.backgroundColor=t?p.backgroundColor:null;v.value=g(q)});e(u,
"Use overridden default color","embed_color",t=>{q.defaultColor=t?p.defaultColor:null;v.value=g(q)});e(u,"Use overridden edge display","embed_edge_display",t=>{const w={showEdges:p.edgeSettings,edgeColor:p.edgeColor,edgeThreshold:p.edgeThreshold};q.edgeSettings=t?w:null;v.value=g(q)});v.value=g(q)})(n,b,a,d);m.Show();return m};OV.Panel=class{constructor(a){this.parentDiv=a;this.panelDiv=OV.AddDiv(a);OV.ShowDomElement(this.panelDiv,!1);this.visible=!1}GetIcon(){return null}IsVisible(){return this.visible}Show(a){this.visible!==a&&(this.visible=a,OV.ShowDomElement(this.panelDiv,this.visible))}Resize(){}Clear(){}};
OV.PanelSet=class{constructor(a){this.parentDiv=a;this.menuDiv=OV.AddDiv(a,"ov_panel_set_menu");this.contentDiv=OV.AddDiv(a,"ov_panel_set_content ov_thin_scrollbar");this.panels=[];this.panelButtons=[];this.panelsVisible=!0;this.callbacks=this.panelsPrevWidth=null}Init(a){this.callbacks=a}GetContentDiv(){return this.contentDiv}AddPanel(a){this.panels.push(a);let b=OV.AddSvgIconElement(this.menuDiv,a.GetIcon(),"ov_panel_set_menu_button");b.setAttribute("alt",a.GetName());b.setAttribute("title",a.GetName());
this.panelButtons.push(b);b.addEventListener("click",()=>{a===this.GetVisiblePanel()?this.ShowPanels(!1):(this.ShowPanels(!0),this.ShowPanel(a))})}IsPanelsVisible(){return this.panelsVisible}ShowPanels(a){if(this.IsParentVisible()&&this.panelsVisible!==a){if(this.panelsVisible=a)OV.ShowDomElement(this.contentDiv,!0),OV.SetDomElementWidth(this.parentDiv,this.menuDiv.offsetWidth+this.panelsPrevWidth);else{for(let b of this.panelButtons)b.classList.remove("selected");for(let b of this.panels)b.Show(!1);
this.panelsPrevWidth=this.contentDiv.offsetWidth;OV.SetDomElementWidth(this.parentDiv,this.menuDiv.offsetWidth);OV.ShowDomElement(this.contentDiv,!1)}this.callbacks.onShowHidePanels(this.panelsVisible);this.callbacks.onResize()}}ShowPanel(a){if(a!==this.GetVisiblePanel()){var b=this.GetPanelButton(a);for(let c of this.panelButtons)c!==b&&c.classList.remove("selected");b.classList.add("selected");for(let c of this.panels)c!==a&&c.Show(!1);a.Show(!0);a.Resize()}}GetVisiblePanel(){if(!this.panelsVisible)return null;
for(let a of this.panels)if(a.IsVisible())return a;return null}SetPanelIcon(a,b){a=this.GetPanelButton(a);OV.SetSvgIconImageElement(a,b)}GetPanelButton(a){a=this.panels.indexOf(a);return this.panelButtons[a]}Resize(){let a=this.parentDiv.offsetHeight;OV.SetDomElementHeight(this.menuDiv,a);OV.SetDomElementHeight(this.contentDiv,a);if(this.panelsVisible)for(let b of this.panels)b.IsVisible()&&b.Resize()}IsParentVisible(){return OV.IsDomElementVisible(this.parentDiv)}Clear(){for(let a of this.panels)a.Clear()}};OV.NavigatorItemRecurse={No:0,Parents:1,Children:2,All:3};OV.MaterialItem=class extends OV.TreeViewSingleItem{constructor(a,b,c){super(a);this.OnClick(()=>{c.onSelected(b)})}};
OV.MeshItem=class extends OV.TreeViewButtonItem{constructor(a,b,c,d){super(a,b);this.meshInstanceId=c;this.visible=!0;this.fitToWindowButton=new OV.TreeViewButton("fit");this.fitToWindowButton.OnClick(()=>{d.onFitToWindow(this.meshInstanceId)});this.AppendButton(this.fitToWindowButton);this.showHideButton=new OV.TreeViewButton("visible");this.showHideButton.OnClick(()=>{d.onShowHide(this.meshInstanceId)});this.AppendButton(this.showHideButton);this.OnClick(()=>{d.onSelected(this.meshInstanceId)})}GetMeshInstanceId(){return this.meshInstanceId}IsVisible(){return this.visible}SetVisible(a,
b){this.visible!==a&&((this.visible=a)?this.showHideButton.SetImage("visible"):this.showHideButton.SetImage("hidden"),b===OV.NavigatorItemRecurse.Parents&&this.parent instanceof OV.NodeItem&&(a=this.parent.CalculateIsVisible(),this.parent.SetVisible(a,OV.NavigatorItemRecurse.Parents)))}};
OV.NodeItem=class extends OV.TreeViewGroupButtonItem{constructor(a,b,c){super(a,null);this.nodeId=b;this.callbacks=c;this.visible=!0;this.fitToWindowButton=new OV.TreeViewButton("fit");this.fitToWindowButton.OnClick(()=>{this.callbacks.onFitToWindow(b)});this.AppendButton(this.fitToWindowButton);this.showHideButton=new OV.TreeViewButton("visible");this.showHideButton.OnClick(()=>{this.callbacks.onShowHide(b)});this.AppendButton(this.showHideButton)}GetNodeId(){return this.nodeId}IsVisible(){return this.visible}CalculateIsVisible(){let a=
!1;for(let b of this.children)if((b instanceof OV.NodeItem||b instanceof OV.MeshItem)&&b.IsVisible()){a=!0;break}return a}SetVisible(a,b){if(this.visible!==a){(this.visible=a)?this.showHideButton.SetImage("visible"):this.showHideButton.SetImage("hidden");if(OV.IsDefined(this.callbacks.onVisibilityChanged))this.callbacks.onVisibilityChanged(this.visible);if(b===OV.NavigatorItemRecurse.Children||b===OV.NavigatorItemRecurse.All)for(let c of this.children)(c instanceof OV.NodeItem||c instanceof OV.MeshItem)&&
c.SetVisible(this.visible,OV.NavigatorItemRecurse.Children);(b===OV.NavigatorItemRecurse.Parents||b===OV.NavigatorItemRecurse.All)&&this.parent instanceof OV.NodeItem&&(a=this.parent.CalculateIsVisible(),this.parent.SetVisible(a,OV.NavigatorItemRecurse.Parents))}}EnumerateMeshItems(a){for(let b of this.children)b instanceof OV.NodeItem?b.EnumerateMeshItems(a):b instanceof OV.MeshItem&&a(b)}};OV.NavigatorPopupButton=class{constructor(a){this.parentDiv=a;this.popup=this.callbacks=null;this.button=OV.AddDiv(this.parentDiv,"ov_navigator_info_button");this.buttonText=OV.AddDiv(this.button,"ov_navigator_info_button_text");OV.AddSvgIconElement(this.button,"arrow_right","ov_navigator_info_button_icon");this.button.addEventListener("click",()=>{this.OnButtonClick()})}Init(a){this.callbacks=a}OnButtonClick(){}Clear(){null!==this.popup&&(this.popup.Hide(),this.popup=null)}};
OV.NavigatorPanel=class extends OV.Panel{constructor(a){super(a);this.callbacks=null;this.titleDiv=OV.AddDiv(this.panelDiv,"ov_navigator_tree_title");this.treeDiv=OV.AddDiv(this.panelDiv,"ov_navigator_tree_panel ov_thin_scrollbar");this.treeView=new OV.TreeView(this.treeDiv);a=this.GetName();this.titleDiv.innerHTML=a;this.titleDiv.setAttribute("title",a)}Clear(){this.treeView.Clear()}GetName(){return null}Init(a){this.callbacks=a}Fill(a){}};OV.NavigatorFilesPanel=class extends OV.NavigatorPanel{constructor(a){super(a)}GetName(){return"Files"}GetIcon(){return"files"}Resize(){let a=OV.GetDomElementOuterHeight(this.titleDiv);OV.SetDomElementHeight(this.treeDiv,this.parentDiv.offsetHeight-a)}Clear(){super.Clear()}Fill(a){super.Fill(a);const b=a.usedFiles;a=a.missingFiles;if(0<a.length){var c=new OV.TreeViewGroupItem("Missing Files",null);c.ShowChildren(!0);this.treeView.AddChild(c);for(var d=0;d<a.length;d++){let e=new OV.TreeViewButtonItem(a[d]),
f=new OV.TreeViewButton("open");f.OnClick(()=>{this.callbacks.onFileBrowseButtonClicked()});e.AppendButton(f);c.AddChild(e)}a=new OV.TreeViewGroupItem("Available Files",null);a.ShowChildren(!0);this.treeView.AddChild(a);for(c=0;c<b.length;c++)d=new OV.TreeViewSingleItem(b[c]),a.AddChild(d)}else for(a=0;a<b.length;a++)c=new OV.TreeViewSingleItem(b[a]),this.treeView.AddChild(c)}};OV.NavigatorMeshesPopupButton=class extends OV.NavigatorPopupButton{constructor(a){super(a);this.meshInfoArray=null}Update(a){this.meshInfoArray=a;null!==this.meshInfoArray&&(this.buttonText.innerHTML="Meshes ("+this.meshInfoArray.length+")")}OnButtonClick(){if(null!==this.meshInfoArray){var a=[];for(let b=0;b<this.meshInfoArray.length;b++)a.push({name:OV.GetMeshName(this.meshInfoArray[b].name)});0!==a.length&&(this.popup=OV.ShowListPopup(a,{calculatePosition:b=>OV.CalculatePopupPositionToElementBottomRight(this.button,
b),onHoverStart:b=>{this.callbacks.onMeshHover(this.meshInfoArray[b].meshId)},onHoverStop:b=>{this.callbacks.onMeshHover(null)},onClick:b=>{this.callbacks.onMeshSelected(this.meshInfoArray[b].meshId)}}))}}};
OV.NavigatorMaterialsPanel=class extends OV.NavigatorPanel{constructor(a){super(a);this.callbacks=null;this.materialIndexToItem=new Map;this.popupDiv=OV.AddDiv(this.panelDiv,"ov_navigator_info_panel");this.meshesButton=new OV.NavigatorMeshesPopupButton(this.popupDiv)}GetName(){return"Materials"}GetIcon(){return"materials"}Resize(){let a=OV.GetDomElementOuterHeight(this.titleDiv),b=OV.GetDomElementOuterHeight(this.popupDiv);OV.SetDomElementHeight(this.treeDiv,this.parentDiv.offsetHeight-a-b)}Clear(){super.Clear();
this.meshesButton.Clear();this.materialIndexToItem=new Map}Init(a){super.Init(a);this.meshesButton.Init({onMeshHover:b=>{this.callbacks.onMeshTemporarySelected(b)},onMeshSelected:b=>{this.callbacks.onMeshSelected(b)}})}Fill(a){super.Fill(a);a=a.model;for(let c=0;c<a.MaterialCount();c++){var b=a.GetMaterial(c);b=OV.GetMaterialName(b.name);b=new OV.MaterialItem(b,c,{onSelected:d=>{this.callbacks.onMaterialSelected(d)}});this.materialIndexToItem.set(c,b);this.treeView.AddChild(b)}}GetMaterialItem(a){return this.materialIndexToItem.get(a)}SelectMaterialItem(a,
b){this.GetMaterialItem(a).SetSelected(b)}UpdateMeshList(a){this.meshesButton.Update(a)}};OV.NavigatorMaterialsPopupButton=class extends OV.NavigatorPopupButton{constructor(a){super(a);this.materialInfoArray=null}Update(a){this.materialInfoArray=a;null!==this.materialInfoArray&&(this.buttonText.innerHTML="Materials ("+this.materialInfoArray.length+")")}OnButtonClick(){if(null!==this.materialInfoArray){var a=[];for(let b=0;b<this.materialInfoArray.length;b++){let c=this.materialInfoArray[b];a.push({name:OV.GetMaterialName(c.name),color:c.color})}0!==a.length&&(this.popup=OV.ShowListPopup(a,
{calculatePosition:b=>OV.CalculatePopupPositionToElementBottomRight(this.button,b),onClick:b=>{this.callbacks.onMaterialSelected(this.materialInfoArray[b].index)}}))}}};
OV.NavigatorMeshesPanel=class extends OV.NavigatorPanel{constructor(a){super(a);this.callbacks=null;this.nodeIdToItem=new Map;this.meshInstanceIdToItem=new Map;this.rootItem=null;this.showTree=!1;this.buttons=null;this.titleDiv.classList.add("nomargin");this.treeView.AddClass("tight");this.buttonsDiv=OV.CreateDiv("ov_navigator_buttons");OV.InsertDomElementBefore(this.buttonsDiv,this.treeDiv);this.popupDiv=OV.AddDiv(this.panelDiv,"ov_navigator_info_panel");this.materialsButton=new OV.NavigatorMaterialsPopupButton(this.popupDiv)}GetName(){return"Meshes"}GetIcon(){return"meshes"}Resize(){let a=
this.titleDiv.offsetHeight,b=OV.GetDomElementOuterHeight(this.buttonsDiv),c=OV.GetDomElementOuterHeight(this.popupDiv);OV.SetDomElementHeight(this.treeDiv,this.parentDiv.offsetHeight-a-b-c)}Clear(){this.ClearMeshTree();OV.ClearDomElement(this.buttonsDiv);this.buttons=null}ClearMeshTree(){super.Clear();this.materialsButton.Clear();this.nodeIdToItem=new Map;this.meshInstanceIdToItem=new Map;this.rootItem=null}Init(a){super.Init(a);this.materialsButton.Init({onMeshHover:b=>{this.callbacks.onMeshTemporarySelected(b)},
onMeshSelected:b=>{this.callbacks.onMeshSelected(b)},onMaterialSelected:b=>{this.callbacks.onMaterialSelected(b)}})}Fill(a){super.Fill(a);const b=a.model;this.FillButtons(a);this.FillMeshTree(b);this.Resize()}FillButtons(a){function b(g,h,l,n){h.div=OV.AddDiv(g,"ov_navigator_button");h.div.setAttribute("alt",h.name);h.div.setAttribute("title",h.name);l&&h.div.classList.add(l);h.iconDiv=OV.AddSvgIconElement(h.div,h.icon);h.div.addEventListener("click",()=>{n()})}function c(g,h,l){h?(g.flatList.iconDiv.classList.remove("selected"),
g.treeView.iconDiv.classList.add("selected")):(g.flatList.iconDiv.classList.add("selected"),g.treeView.iconDiv.classList.remove("selected"));h=h&&l;OV.ShowDomElement(g.separator,h);OV.ShowDomElement(g.expandAll.div,h);OV.ShowDomElement(g.collapseAll.div,h)}function d(g,h,l){let n=[];g.EnumerateMeshItems(m=>{m.IsVisible()||n.push(m.GetMeshInstanceId());return!0});g.ClearMeshTree();g.FillMeshTree(h.model);for(let m of n)g.GetMeshItem(m).SetVisible(!1,OV.NavigatorItemRecurse.Parents);c(g.buttons,g.showTree,
l);g.callbacks.onViewTypeChanged()}this.buttons={flatList:{name:"Flat list",icon:"flat_list",div:null,iconDiv:null},treeView:{name:"Tree view",icon:"tree_view",div:null,iconDiv:null},separator:null,expandAll:{name:"Expand all",icon:"expand",div:null,iconDiv:null},collapseAll:{name:"Collapse all",icon:"collapse",div:null,iconDiv:null},showHideMeshes:{name:"Show/hide meshes",icon:"visible",div:null,iconDiv:null},fitToWindow:{name:"Fit meshes to window",icon:"fit",div:null,iconDiv:null}};const e=a.model.GetRootNode();
let f=!1;for(let g of e.GetChildNodes())if(g.GetType()===OV.NodeType.GroupNode){f=!0;break}b(this.buttonsDiv,this.buttons.flatList,null,()=>{this.showTree&&(this.showTree=!1,d(this,a,f))});b(this.buttonsDiv,this.buttons.treeView,null,()=>{this.showTree||(this.showTree=!0,d(this,a,f))});this.buttons.separator=OV.AddDiv(this.buttonsDiv,"ov_navigator_buttons_separator");b(this.buttonsDiv,this.buttons.expandAll,null,()=>{this.rootItem.ExpandAll(!0)});b(this.buttonsDiv,this.buttons.collapseAll,null,()=>
{this.rootItem.ExpandAll(!1)});b(this.buttonsDiv,this.buttons.showHideMeshes,"right",()=>{let g=this.rootItem.GetNodeId();this.callbacks.onNodeShowHide(g)});b(this.buttonsDiv,this.buttons.fitToWindow,"right",()=>{let g=this.rootItem.GetNodeId();this.callbacks.onNodeFitToWindow(g)});c(this.buttons,this.showTree,f)}FillMeshTree(a){function b(f,g,h,l,n,m){g=g.GetMesh(l);g=OV.GetMeshName(g.GetName());h=new OV.MeshInstanceId(h.GetId(),l);m=new OV.MeshItem(g,m?"tree_mesh":null,h,{onShowHide:k=>{f.callbacks.onMeshShowHide(k)},
onFitToWindow:k=>{f.callbacks.onMeshFitToWindow(k)},onSelected:k=>{f.callbacks.onMeshSelected(k)}});f.meshInstanceIdToItem.set(h.GetKey(),m);n.AddChild(m)}function c(f,g){var h=OV.GetNodeName(g.GetName());g=g.GetId();h=new OV.NodeItem(h,g,{onShowHide:l=>{f.callbacks.onNodeShowHide(l)},onFitToWindow:l=>{f.callbacks.onNodeFitToWindow(l)}});f.nodeIdToItem.set(g,h);return h}function d(f,g,h,l,n){let m=[];for(let k of h.GetChildNodes())if(n)if(k.GetType()===OV.NodeType.GroupNode){let p=c(f,k);l.AddChild(p);
d(f,g,k,p,n)}else k.GetType()===OV.NodeType.MeshNode&&m.push(k);else d(f,g,k,l,n);for(let k of m)d(f,g,k,l,n);for(let k of h.GetMeshIndices())b(f,g,h,k,l,n)}let e=a.GetRootNode();this.rootItem=function(f,g){g=g.GetId();let h=new OV.NodeItem(null,g,{onVisibilityChanged:l=>{l?OV.SetSvgIconImageElement(f.buttons.showHideMeshes.iconDiv,"visible"):OV.SetSvgIconImageElement(f.buttons.showHideMeshes.iconDiv,"hidden")}});h.Show(!1);h.ShowChildren(!0);f.treeView.AddChild(h);f.nodeIdToItem.set(g,h);return h}(this,
e);d(this,a,e,this.rootItem,this.showTree)}UpdateMaterialList(a){this.materialsButton.Update(a)}GetNodeItem(a){return this.nodeIdToItem.get(a)}MeshItemCount(){return this.meshInstanceIdToItem.size}GetMeshItem(a){return this.meshInstanceIdToItem.get(a.GetKey())}EnumerateNodeItems(a){for(const b of this.nodeIdToItem.values())if(!a(b))break}EnumerateMeshItems(a){for(const b of this.meshInstanceIdToItem.values())if(!a(b))break}IsMeshVisible(a){return this.GetMeshItem(a).IsVisible()}HasHiddenMesh(){let a=
!1;this.EnumerateMeshItems(b=>b.IsVisible()?!0:(a=!0,!1));return a}ShowAllMeshes(a){this.EnumerateNodeItems(b=>{b.SetVisible(a,OV.NavigatorItemRecurse.No);return!0});this.EnumerateMeshItems(b=>{b.SetVisible(a,OV.NavigatorItemRecurse.No);return!0})}ToggleNodeVisibility(a){a=this.GetNodeItem(a);a.SetVisible(!a.IsVisible(),OV.NavigatorItemRecurse.All)}ToggleMeshVisibility(a){a=this.GetMeshItem(a);a.SetVisible(!a.IsVisible(),OV.NavigatorItemRecurse.Parents)}IsMeshIsolated(a){let b=!0;this.EnumerateMeshItems(c=>
!c.GetMeshInstanceId().IsEqual(a)&&c.IsVisible()?b=!1:!0);return b}IsolateMesh(a){this.ShowAllMeshes(!1);this.ToggleMeshVisibility(a)}};OV.SelectionType={Material:1,Mesh:2};OV.Selection=class{constructor(a,b){this.type=a;this.meshInstanceId=this.materialIndex=null;this.type===OV.SelectionType.Material?this.materialIndex=b:this.type===OV.SelectionType.Mesh&&(this.meshInstanceId=b)}IsEqual(a){if(this.type!==a.type)return!1;if(this.type===OV.SelectionType.Material)return this.materialIndex===a.materialIndex;if(this.type===OV.SelectionType.Mesh)return this.meshInstanceId.IsEqual(a.meshInstanceId)}};
OV.Navigator=class{constructor(a,b){this.mainDiv=a;this.splitterDiv=b;this.panelSet=new OV.PanelSet(a);this.tempSelectedMeshId=this.selection=this.callbacks=null;this.filesPanel=new OV.NavigatorFilesPanel(this.panelSet.GetContentDiv());this.materialsPanel=new OV.NavigatorMaterialsPanel(this.panelSet.GetContentDiv());this.meshesPanel=new OV.NavigatorMeshesPanel(this.panelSet.GetContentDiv());this.panelSet.AddPanel(this.filesPanel);this.panelSet.AddPanel(this.materialsPanel);this.panelSet.AddPanel(this.meshesPanel);
this.panelSet.ShowPanel(this.meshesPanel)}ShowPanels(a){this.panelSet.ShowPanels(a)}Init(a){this.callbacks=a;this.panelSet.Init({onResize:()=>{OV.ShowDomElement(this.splitterDiv,this.panelSet.IsPanelsVisible());this.callbacks.onResize()},onShowHidePanels:b=>{this.callbacks.onShowHidePanels(b)}});this.filesPanel.Init({onFileBrowseButtonClicked:()=>{this.callbacks.openFileBrowserDialog()}});this.materialsPanel.Init({onMaterialSelected:b=>{this.SetSelection(new OV.Selection(OV.SelectionType.Material,
b))},onMeshTemporarySelected:b=>{this.tempSelectedMeshId=b;this.callbacks.updateMeshesSelection()},onMeshSelected:b=>{this.SetSelection(new OV.Selection(OV.SelectionType.Mesh,b))}});this.meshesPanel.Init({onMeshSelected:b=>{this.SetSelection(new OV.Selection(OV.SelectionType.Mesh,b))},onMeshShowHide:b=>{this.ToggleMeshVisibility(b)},onMeshFitToWindow:b=>{this.FitMeshToWindow(b)},onNodeShowHide:b=>{this.ToggleNodeVisibility(b)},onNodeFitToWindow:b=>{this.FitNodeToWindow(b)},onMaterialSelected:b=>{this.SetSelection(new OV.Selection(OV.SelectionType.Material,
b))},onViewTypeChanged:()=>{this.SetSelection(null)}});OV.InstallVerticalSplitter(this.splitterDiv,this.mainDiv,!1,()=>{this.callbacks.onResize()})}GetWidth(){let a=OV.GetDomElementOuterWidth(this.mainDiv),b=0;this.panelSet.IsPanelsVisible()&&(b=this.splitterDiv.offsetWidth);return a+b}Resize(a){OV.SetDomElementOuterHeight(this.mainDiv,a);OV.SetDomElementHeight(this.splitterDiv,a);this.panelSet.Resize()}FillTree(a){this.filesPanel.Fill(a);0===a.missingFiles.length?this.panelSet.SetPanelIcon(this.filesPanel,
"files"):this.panelSet.SetPanelIcon(this.filesPanel,"missing_files");this.materialsPanel.Fill(a);this.meshesPanel.Fill(a);this.OnSelectionChanged()}MeshItemCount(){return this.meshesPanel.MeshItemCount()}IsMeshVisible(a){return this.meshesPanel.IsMeshVisible(a)}HasHiddenMesh(){return this.meshesPanel.HasHiddenMesh()}ShowAllMeshes(a){this.meshesPanel.ShowAllMeshes(a);this.callbacks.updateMeshesVisibility()}ToggleNodeVisibility(a){this.meshesPanel.ToggleNodeVisibility(a);this.callbacks.updateMeshesVisibility()}ToggleMeshVisibility(a){this.meshesPanel.ToggleMeshVisibility(a);
this.callbacks.updateMeshesVisibility()}IsMeshIsolated(a){return this.meshesPanel.IsMeshIsolated(a)}IsolateMesh(a){this.meshesPanel.IsolateMesh(a);this.callbacks.updateMeshesVisibility()}GetSelectedMeshId(){return null!==this.tempSelectedMeshId?this.tempSelectedMeshId:null===this.selection||this.selection.type!==OV.SelectionType.Mesh?null:this.selection.meshInstanceId}SetSelection(a){function b(d,e,f){e.type===OV.SelectionType.Material?(f&&d.panelSet.IsPanelsVisible()&&d.panelSet.ShowPanel(d.materialsPanel),
d.materialsPanel.SelectMaterialItem(e.materialIndex,f)):e.type===OV.SelectionType.Mesh&&(f&&d.panelSet.IsPanelsVisible()&&d.panelSet.ShowPanel(d.meshesPanel),d.meshesPanel.GetMeshItem(e.meshInstanceId).SetSelected(f))}let c=this.selection;null!==c&&b(this,c,!1);this.selection=a;this.OnSelectionChanged();this.tempSelectedMeshId=null;null!==this.selection&&(null!==c&&c.IsEqual(this.selection)?(b(this,this.selection,!1),this.selection=null,this.OnSelectionChanged()):b(this,this.selection,!0));this.callbacks.updateMeshesSelection()}OnSelectionChanged(){if(null===
this.selection)this.callbacks.onModelSelected();else if(this.selection.type===OV.SelectionType.Material)this.callbacks.onMaterialSelected(this.selection.materialIndex);else if(this.selection.type===OV.SelectionType.Mesh)this.callbacks.onMeshSelected(this.selection.meshInstanceId);this.UpdatePanels()}UpdatePanels(){var a=null,b=null;null!==this.selection&&(this.selection.type===OV.SelectionType.Material?a=this.selection.materialIndex:this.selection.type===OV.SelectionType.Mesh&&(b=this.selection.meshInstanceId));
a=this.callbacks.getMeshesForMaterial(a);this.materialsPanel.UpdateMeshList(a);b=this.callbacks.getMaterialsForMesh(b);this.meshesPanel.UpdateMaterialList(b)}FitNodeToWindow(a){let b=new Set;this.meshesPanel.GetNodeItem(a).EnumerateMeshItems(c=>{b.add(c.GetMeshInstanceId())});this.callbacks.fitMeshesToWindow(b)}FitMeshToWindow(a){this.callbacks.fitMeshToWindow(a)}Clear(){this.panelSet.Clear();this.selection=null}};OV.SidebarPanel=class extends OV.Panel{constructor(a){super(a);this.callbacks=null;this.titleDiv=OV.AddDiv(this.panelDiv,"ov_sidebar_title");this.contentDiv=OV.AddDiv(this.panelDiv,"ov_sidebar_content ov_thin_scrollbar");a=this.GetName();OV.AddDiv(this.titleDiv,"ov_sidebar_title_text",this.GetName());this.titleDiv.setAttribute("title",a)}GetName(){return null}Clear(){OV.ClearDomElement(this.contentDiv)}Init(a){this.callbacks=a}};OV.SidebarDetailsPanel=class extends OV.SidebarPanel{constructor(a){super(a)}GetName(){return"Details"}GetIcon(){return"details"}AddObject3DProperties(a){this.Clear();var b=OV.AddDiv(this.contentDiv,"ov_property_table"),c=OV.GetBoundingBox(a);c=OV.SubCoord3D(c.max,c.min);this.AddProperty(b,new OV.Property(OV.PropertyType.Integer,"Vertices",a.VertexCount()));this.AddProperty(b,new OV.Property(OV.PropertyType.Integer,"Triangles",a.TriangleCount()));this.AddProperty(b,new OV.Property(OV.PropertyType.Number,
"Size X",c.x));this.AddProperty(b,new OV.Property(OV.PropertyType.Number,"Size Y",c.y));this.AddProperty(b,new OV.Property(OV.PropertyType.Number,"Size Z",c.z));this.AddCalculatedProperty(b,"Volume",()=>{if(!OV.IsSolid(a))return null;const d=OV.CalculateVolume(a);return null===d?null:new OV.Property(OV.PropertyType.Number,null,d)});this.AddCalculatedProperty(b,"Surface",()=>{const d=OV.CalculateSurfaceArea(a);return null===d?null:new OV.Property(OV.PropertyType.Number,null,d)});if(0<a.PropertyGroupCount())for(b=
OV.AddDiv(this.contentDiv,"ov_property_table ov_property_table_custom"),c=0;c<a.PropertyGroupCount();c++){const d=a.GetPropertyGroup(c);this.AddPropertyGroup(b,d);for(let e=0;e<d.PropertyCount();e++){const f=d.GetProperty(e);this.AddPropertyInGroup(b,f)}}this.Resize()}AddMaterialProperties(a){function b(e,f,g,h){null!==h&&null!==h.name&&(h=OV.GetFileName(h.name),e.AddProperty(f,new OV.Property(OV.PropertyType.Text,g,h)))}this.Clear();let c=OV.AddDiv(this.contentDiv,"ov_property_table"),d=null;a.type===
OV.MaterialType.Phong?d="Phong":a.type===OV.MaterialType.Physical&&(d="Physical");this.AddProperty(c,new OV.Property(OV.PropertyType.Text,"Source",a.isDefault?"Default":"Model"));this.AddProperty(c,new OV.Property(OV.PropertyType.Text,"Type",d));a.vertexColors?this.AddProperty(c,new OV.Property(OV.PropertyType.Text,"Color","Vertex colors")):(this.AddProperty(c,new OV.Property(OV.PropertyType.Color,"Color",a.color)),a.type===OV.MaterialType.Phong&&(this.AddProperty(c,new OV.Property(OV.PropertyType.Color,
"Ambient",a.ambient)),this.AddProperty(c,new OV.Property(OV.PropertyType.Color,"Specular",a.specular))));a.type===OV.MaterialType.Physical&&(this.AddProperty(c,new OV.Property(OV.PropertyType.Percent,"Metalness",a.metalness)),this.AddProperty(c,new OV.Property(OV.PropertyType.Percent,"Roughness",a.roughness)));this.AddProperty(c,new OV.Property(OV.PropertyType.Percent,"Opacity",a.opacity));b(this,c,"Diffuse Map",a.diffuseMap);b(this,c,"Bump Map",a.bumpMap);b(this,c,"Normal Map",a.normalMap);b(this,
c,"Emissive Map",a.emissiveMap);a.type===OV.MaterialType.Phong?b(this,c,"Specular Map",a.specularMap):a.type===OV.MaterialType.Physical&&b(this,c,"Metallic Map",a.metalnessMap);this.Resize()}AddPropertyGroup(a,b){OV.AddDiv(a,"ov_property_table_row group",b.name).setAttribute("title",b.name)}AddProperty(a,b){a=OV.AddDiv(a,"ov_property_table_row");let c=OV.AddDiv(a,"ov_property_table_cell ov_property_table_name",b.name+":"),d=OV.AddDiv(a,"ov_property_table_cell ov_property_table_value");c.setAttribute("title",
b.name);this.DisplayPropertyValue(b,d);return a}AddPropertyInGroup(a,b){this.AddProperty(a,b).classList.add("ingroup")}AddCalculatedProperty(a,b,c){a=OV.AddDiv(a,"ov_property_table_row");let d=OV.AddDiv(a,"ov_property_table_cell ov_property_table_name",b+":"),e=OV.AddDiv(a,"ov_property_table_cell ov_property_table_value");d.setAttribute("title",b);OV.AddDiv(e,"ov_property_table_button","Calculate...").addEventListener("click",()=>{OV.ClearDomElement(e);e.innerHTML="Please wait...";OV.RunTaskAsync(()=>
{let f=c();null===f?e.innerHTML="-":this.DisplayPropertyValue(f,e)})})}DisplayPropertyValue(a,b){OV.ClearDomElement(b);let c=null;if(a.type===OV.PropertyType.Text)c=a.value;else if(a.type===OV.PropertyType.Integer)c=a.value.toLocaleString();else if(a.type===OV.PropertyType.Number)c=a.value.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});else if(a.type===OV.PropertyType.Boolean)c=a.value?"True":"False";else if(a.type===OV.PropertyType.Percent)c=parseInt(100*a.value,10).toString()+
"%";else if(a.type===OV.PropertyType.Color){let d="#"+OV.ColorToHexString(a.value);a=OV.CreateInlineColorCircle(a.value);b.appendChild(a);OV.AddDomElement(b,"span",null,d)}null!==c&&(b.innerHTML=c,b.setAttribute("title",c))}};OV.AddColorPicker=function(a,b,c,d){a=Pickr.create({el:a,theme:"monolith",position:"left-start",swatches:c,comparison:!1,default:"#"+OV.ColorToHexString(b),components:{preview:!1,opacity:!1,hue:!0,interaction:{hex:!1,rgba:!1,hsla:!1,hsva:!1,cmyk:!1,input:!0,clear:!1,save:!1}}});a.on("change",(e,f,g)=>{e=e.toRGBA();e=new OV.Color(parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10));d(e)});return a};
OV.SettingsColorSection=class{constructor(a){this.parentDiv=a;this.pickr=this.contentDiv=null}Init(a,b,c,d,e){this.contentDiv=OV.AddDiv(this.parentDiv,"ov_sidebar_settings_content");let f=OV.AddDiv(this.contentDiv,"ov_sidebar_subtitle"),g=OV.AddDiv(f,"ov_color_picker");OV.AddDiv(f,"ov_sidebar_subtitle",a);this.pickr=OV.AddColorPicker(g,c,d,h=>{e(h)});OV.AddDiv(this.contentDiv,"ov_sidebar_settings_padded",b)}Show(a){OV.ShowDomElement(this.contentDiv,a)}Update(a){null!==this.pickr&&this.pickr.setColor("#"+
OV.ColorToHexString(a))}Clear(){null!==this.pickr&&this.pickr.hide()}};
OV.SettingsGridDisplaySection=class{constructor(a){this.parentDiv=a;this.gridDisplayToggle=null}Init(a,b){var c=OV.AddDiv(this.parentDiv,"ov_sidebar_settings_content");c=OV.AddDiv(c,"ov_sidebar_subtitle");this.showGridToggle=OV.AddToggle(c,"ov_sidebar_subtitle_toggle");this.showGridToggle.OnChange(()=>{b(this.showGridToggle.GetStatus())});OV.AddDiv(c,"ov_sidebar_subtitle_text","Show Grid");this.showGridToggle.SetStatus(a)}Update(a){null!==this.showGridToggle&&this.showGridToggle.SetStatus(a)}};
OV.SettingsEdgeDisplaySection=class{constructor(a){this.parentDiv=a;this.edgeSettingsDiv=this.thresholdSliderValue=this.thresholdSlider=this.pickr=this.edgeDisplayToggle=null}Init(a,b,c,d){var e=OV.AddDiv(this.parentDiv,"ov_sidebar_settings_content"),f=OV.AddDiv(e,"ov_sidebar_subtitle");this.edgeDisplayToggle=OV.AddToggle(f,"ov_sidebar_subtitle_toggle");OV.AddDiv(f,"ov_sidebar_subtitle_text","Show Edges");this.edgeSettingsDiv=OV.AddDiv(e,"ov_sidebar_settings_padded");this.edgeDisplayToggle.OnChange(()=>
{OV.ShowDomElement(this.edgeSettingsDiv,this.edgeDisplayToggle.GetStatus());d.onShowEdgesChange(this.edgeDisplayToggle.GetStatus()?!0:!1)});e=OV.AddDiv(this.edgeSettingsDiv,"ov_sidebar_settings_row");f=OV.AddDiv(e,"ov_color_picker");this.pickr=OV.AddColorPicker(f,b,"#ffffff #e3e3e3 #c9c9c9 #898989 #5f5f5f #494949 #383838 #0f0f0f".split(" "),g=>{d.onEdgeColorChange(g)});OV.AddDiv(e,null,"Edge Color");b=OV.AddDiv(this.edgeSettingsDiv,"ov_sidebar_settings_row large");this.thresholdSlider=OV.AddRangeSlider(b,
0,90);this.thresholdSlider.setAttribute("title","Edge Angle Threshold");this.thresholdSliderValue=OV.AddDomElement(b,"span","ov_slider_label");this.thresholdSlider.addEventListener("input",()=>{this.thresholdSliderValue.innerHTML=this.thresholdSlider.value});this.thresholdSlider.addEventListener("change",()=>{d.onEdgeThresholdChange(this.thresholdSlider.value)});this.thresholdSlider.value=c;this.thresholdSliderValue.innerHTML=c;this.edgeDisplayToggle.SetStatus(a);this.ShowEdgeSettings(a)}Update(a,
b,c){null!==this.edgeDisplayToggle&&(this.edgeDisplayToggle.SetStatus(a),this.ShowEdgeSettings(a),this.pickr.setColor("#"+OV.ColorToHexString(b)),this.thresholdSlider.value=c,this.thresholdSliderValue.innerHTML=c)}ShowEdgeSettings(a){OV.ShowDomElement(this.edgeSettingsDiv,a)}Clear(){null!==this.pickr&&this.pickr.hide()}};
OV.SettingsThemeSection=class{constructor(a){this.parentDiv=a;this.darkModeToggle=null}Init(a,b){var c=OV.AddDiv(this.parentDiv,"ov_sidebar_settings_content");c=OV.AddDiv(c,"ov_sidebar_subtitle");this.darkModeToggle=OV.AddToggle(c,"ov_sidebar_subtitle_toggle");this.darkModeToggle.OnChange(()=>{b(this.darkModeToggle.GetStatus()?OV.Theme.Dark:OV.Theme.Light)});OV.AddDiv(c,"ov_sidebar_subtitle_text","Dark Mode");this.darkModeToggle.SetStatus(a===OV.Theme.Dark)}Update(a){null!==this.darkModeToggle&&this.darkModeToggle.SetStatus(a===
OV.Theme.Dark)}};
OV.SidebarSettingsPanel=class extends OV.SidebarPanel{constructor(a,b){super(a);this.settings=b;this.sectionsDiv=OV.AddDiv(this.contentDiv,"ov_sidebar_settings_sections ov_thin_scrollbar");this.backgroundColorSection=new OV.SettingsColorSection(this.sectionsDiv);this.defaultColorSection=new OV.SettingsColorSection(this.sectionsDiv);this.gridDisplaySection=null;OV.FeatureSet.ShowGrid&&(this.gridDisplaySection=new OV.SettingsGridDisplaySection(this.sectionsDiv));this.edgeDisplaySection=new OV.SettingsEdgeDisplaySection(this.sectionsDiv);
this.themeSection=new OV.SettingsThemeSection(this.sectionsDiv);this.resetToDefaultsButton=OV.AddDiv(this.contentDiv,"ov_button ov_sidebar_button outline","Reset to Default");this.resetToDefaultsButton.addEventListener("click",()=>{this.ResetToDefaults()})}GetName(){return"Settings"}GetIcon(){return"settings"}Clear(){this.backgroundColorSection.Clear();this.defaultColorSection.Clear();this.edgeDisplaySection.Clear()}Init(a){super.Init(a);this.backgroundColorSection.Init("Background Color","Affects only the visualization.",
this.settings.backgroundColor,"#ffffff #e3e3e3 #c9c9c9 #898989 #5f5f5f #494949 #383838 #0f0f0f".split(" "),b=>{this.SetBackgroundColor(b,!1)});this.defaultColorSection.Init("Default Color","Appears when the model doesn't have materials.",this.settings.defaultColor,"#ffffff #e3e3e3 #cc3333 #fac832 #4caf50 #3393bd #9b27b0 #fda4b8".split(" "),b=>{this.SetDefaultColor(b,!1)});null!==this.gridDisplaySection&&this.gridDisplaySection.Init(this.settings.showGrid,b=>{this.settings.showGrid=b;a.onGridDisplayChange()});
this.edgeDisplaySection.Init(this.settings.showEdges,this.settings.edgeColor,this.settings.edgeThreshold,{onShowEdgesChange:b=>{this.settings.showEdges=b;a.onEdgeDisplayChange()},onEdgeColorChange:b=>{this.settings.edgeColor=b;a.onEdgeDisplayChange()},onEdgeThresholdChange:b=>{this.settings.edgeThreshold=b;a.onEdgeDisplayChange()}});this.themeSection.Init(this.settings.themeId,b=>{this.settings.themeId=b;b===OV.Theme.Light?(this.SetBackgroundColor(new OV.Color(255,255,255),!0),this.SetDefaultColor(new OV.Color(200,
200,200),!0)):b===OV.Theme.Dark&&(this.SetBackgroundColor(new OV.Color(42,43,46),!0),this.SetDefaultColor(new OV.Color(200,200,200),!0));a.onThemeChange()})}UpdateSettings(a){this.defaultColorSection.Show(a);this.Resize()}SetBackgroundColor(a,b){this.settings.backgroundColor=a;if(b)this.backgroundColorSection.Update(a);else this.callbacks.onBackgroundColorChange()}SetDefaultColor(a,b){this.settings.defaultColor=a;if(b)this.defaultColorSection.Update(a);else this.callbacks.onDefaultColorChange()}ResetToDefaults(){let a=
new OV.Settings;this.settings.backgroundColor=a.backgroundColor;this.settings.defaultColor=a.defaultColor;this.settings.showGrid=a.showGrid;this.settings.showEdges=a.showEdges;this.settings.edgeColor=a.edgeColor;this.settings.edgeThreshold=a.edgeThreshold;this.settings.themeId=a.themeId;this.backgroundColorSection.Update(a.backgroundColor);this.defaultColorSection.Update(a.defaultColor);null!==this.gridDisplaySection&&this.gridDisplaySection.Update(a.showGrid);this.edgeDisplaySection.Update(a.showEdges,
a.edgeColor,a.edgeThreshold);this.themeSection.Update(a.themeId);if(null!==this.gridDisplaySection)this.callbacks.onGridDisplayChange();this.callbacks.onThemeChange()}Resize(){let a=OV.GetDomElementOuterHeight(this.titleDiv),b=OV.GetDomElementOuterHeight(this.resetToDefaultsButton);OV.SetDomElementOuterHeight(this.sectionsDiv,this.parentDiv.offsetHeight-a-b)}};OV.SidebarMeasurePanel=class extends OV.SidebarPanel{constructor(a,b){super(a);this.measureTool=b;this.resultSection=this.helpSection=null}GetName(){return"Measure"}GetIcon(){return"measure"}Init(a){super.Init(a);let b=!1,c=OV.AddDiv(this.contentDiv,"ov_button ov_sidebar_button","Activate");c.addEventListener("click",()=>{(b=!b)?(c.classList.add("outline"),c.innerHTML="Deactivate"):(c.classList.remove("outline"),c.innerHTML="Activate");this.callbacks.onActivatedChange(b)});this.helpSection=OV.AddDiv(this.contentDiv,
"ov_sidebar_section");this.resultSection=OV.AddDiv(this.contentDiv,"ov_sidebar_section");this.helpSection.innerHTML=this.GetDefaultHelpText()}UpdateMeasureTool(){OV.ClearDomElement(this.helpSection);OV.ClearDomElement(this.resultSection);OV.ShowDomElement(this.helpSection,!0);OV.ShowDomElement(this.resultSection,!1);if(this.measureTool.IsActive()){var a=this.measureTool.GetMarkerCount();if(0===a)this.helpSection.innerHTML="Click on a model point to start measure.";else if(1===a)this.helpSection.innerHTML=
"Click on another model point to see the results.";else if(2===a){OV.ShowDomElement(this.helpSection,!1);OV.ShowDomElement(this.resultSection,!0);a=this.measureTool.Calculate();OV.AddDiv(this.resultSection,"ov_sidebar_measure_name","Distance of points");var b=a.pointsDistance.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:4});OV.AddDiv(this.resultSection,"ov_sidebar_measure_value",b);OV.AddDiv(this.resultSection,"ov_sidebar_measure_name","Distance of parallel faces");null!==
a.parallelFacesDistance?(b=a.parallelFacesDistance.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:4}),OV.AddDiv(this.resultSection,"ov_sidebar_measure_value",b)):OV.AddDiv(this.resultSection,"ov_sidebar_measure_value","Faces are not parallel");OV.AddDiv(this.resultSection,"ov_sidebar_measure_name","Angle of faces");a=(a.facesAngle*OV.RadDeg).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:4});OV.AddDiv(this.resultSection,"ov_sidebar_measure_value",a+"\u00b0")}}else this.helpSection.innerHTML=
this.GetDefaultHelpText()}GetDefaultHelpText(){return"<ol>\n        <li>Activate measure mode with the button above.</li>\n        <li>Click two points in the model to see the results.</li>\n        </ol>"}Clear(){}};OV.Sidebar=class{constructor(a,b,c,d){this.mainDiv=a;this.splitterDiv=b;this.panelSet=new OV.PanelSet(a);this.detailsPanel=new OV.SidebarDetailsPanel(this.panelSet.GetContentDiv());this.settingsPanel=new OV.SidebarSettingsPanel(this.panelSet.GetContentDiv(),c);this.measurePanel=new OV.SidebarMeasurePanel(this.panelSet.GetContentDiv(),d);this.panelSet.AddPanel(this.detailsPanel);this.panelSet.AddPanel(this.settingsPanel);OV.FeatureSet.MeasureTool&&this.panelSet.AddPanel(this.measurePanel);this.panelSet.ShowPanel(this.detailsPanel)}IsPanelsVisible(){return this.panelSet.IsPanelsVisible()}ShowPanels(a){this.panelSet.ShowPanels(a)}Init(a){this.callbacks=
a;this.panelSet.Init({onResize:()=>{OV.ShowDomElement(this.splitterDiv,this.panelSet.IsPanelsVisible());this.callbacks.onResize()},onShowHidePanels:b=>{this.callbacks.onShowHidePanels(b)}});this.settingsPanel.Init({onBackgroundColorChange:()=>{this.callbacks.onBackgroundColorChange()},onDefaultColorChange:()=>{this.callbacks.onDefaultColorChange()},onGridDisplayChange:()=>{this.callbacks.onGridDisplayChange()},onEdgeDisplayChange:()=>{this.callbacks.onEdgeDisplayChange()},onThemeChange:()=>{this.callbacks.onThemeChange()}});
this.measurePanel.Init({onActivatedChange:b=>{this.callbacks.onMeasureToolActivedChange(b)}});OV.InstallVerticalSplitter(this.splitterDiv,this.mainDiv,!0,()=>{this.callbacks.onResize()})}UpdateSettings(a){this.settingsPanel.UpdateSettings(a)}UpdateMeasureTool(){this.measurePanel.UpdateMeasureTool()}Resize(a){OV.SetDomElementOuterHeight(this.mainDiv,a);OV.SetDomElementHeight(this.splitterDiv,a);this.panelSet.Resize()}GetWidth(){let a=OV.GetDomElementOuterWidth(this.mainDiv),b=0;this.panelSet.IsPanelsVisible()&&
(b=this.splitterDiv.offsetWidth);return a+b}DecreaseWidth(a){OV.SetDomElementWidth(this.mainDiv,this.mainDiv.offsetWidth-a)}Clear(){this.panelSet.Clear()}AddObject3DProperties(a){this.detailsPanel.AddObject3DProperties(a)}AddMaterialProperties(a){this.detailsPanel.AddMaterialProperties(a)}};OV.HashHandler=class{constructor(){this.skipNextEvent=!1;this.eventListener=null}SetEventListener(a){this.eventListener=a;window.onhashchange=this.OnChange.bind(this)}SkipNextEventHandler(){this.skipNextEvent=!0}HasHash(){return 0<this.GetHash().length}ClearHash(){this.SetHash("")}GetModelFilesFromHash(){return OV.CreateUrlParser(this.GetHash()).GetModelUrls()}SetModelFilesToHash(a){a=OV.CreateModelUrlParameters(a);this.SetHash(a)}GetCameraFromHash(){return OV.CreateUrlParser(this.GetHash()).GetCamera()}GetBackgroundFromHash(){return OV.CreateUrlParser(this.GetHash()).GetBackgroundColor()}GetDefaultColorFromHash(){return OV.CreateUrlParser(this.GetHash()).GetDefaultColor()}GetEdgeSettingsFromHash(){return OV.CreateUrlParser(this.GetHash()).GetEdgeSettings()}GetHash(){return window.location.hash.substr(1)}SetHash(a){window.location.hash=
a}OnChange(){this.skipNextEvent?this.skipNextEvent=!1:this.eventListener()}};OV.ThreeModelLoaderUI=class{constructor(){this.modelLoader=new OV.ThreeModelLoader;this.modalDialog=null}LoadModel(a,b,c,d){if(!this.modelLoader.InProgress()){var e=null;this.modelLoader.LoadModel(a,b,c,{onLoadStart:()=>{this.CloseDialogIfOpen();d.onStart();e=new OV.ProgressDialog;e.Init("Loading Model");e.Show()},onSelectMainFile:(f,g)=>{e.Hide();this.modalDialog=this.ShowFileSelectorDialog(f,h=>{e.Show();g(h)})},onImportStart:()=>{e.SetText("Importing Model")},onVisualizationStart:()=>{e.SetText("Visualizing Model")},
onModelFinished:(f,g)=>{e.Hide();d.onFinish(f,g)},onTextureLoaded:()=>{d.onRender()},onLoadError:f=>{e.Hide();d.onError(f);this.modalDialog=this.ShowErrorDialog(f)}})}}GetModelLoader(){return this.modelLoader}GetImporter(){return this.modelLoader.GetImporter()}ShowErrorDialog(a){return a.code===OV.ImportErrorCode.NoImportableFile?OV.ShowMessageDialog("Something went wrong","No importable file found.",a.message):a.code===OV.ImportErrorCode.FailedToLoadFile?OV.ShowMessageDialog("Something went wrong",
"Failed to load file for import.",a.message):a.code===OV.ImportErrorCode.ImportFailed?OV.ShowMessageDialog("Something went wrong","Failed to import model.",a.message):OV.ShowMessageDialog("Something went wrong","Unknown error.",a.message)}ShowFileSelectorDialog(a,b){let c=new OV.ButtonDialog;var d=c.Init("Select Model",[{name:"Cancel",subClass:"outline",onClick(){c.Hide()}}]);c.SetCloseHandler(()=>{b(null)});OV.AddDiv(d,"ov_dialog_message","Multiple importable models found. Select the model you would like to import from the list below.");
d=OV.AddDiv(d,"ov_dialog_section");d=OV.AddDiv(d,"ov_dialog_import_file_list ov_thin_scrollbar");for(let e=0;e<a.length;e++){let f=a[e],g=OV.AddDiv(d,"ov_dialog_file_link");OV.AddSvgIconElement(g,"meshes","ov_file_link_img");OV.AddDiv(g,"ov_dialog_file_link_text",f);g.addEventListener("click",()=>{c.SetCloseHandler(null);c.Hide();b(e)})}c.Show();return c}CloseDialogIfOpen(){null!==this.modalDialog&&(this.modalDialog.Hide(),this.modalDialog=null)}};OV.ThemeHandler=class{constructor(){this.css={"--ov_foreground_color":{},"--ov_background_color":{},"--ov_button_color":{},"--ov_button_hover_color":{},"--ov_button_text_color":{},"--ov_outline_button_color":{},"--ov_outline_button_hover_color":{},"--ov_outline_button_text_color":{},"--ov_icon_color":{},"--ov_light_icon_color":{},"--ov_selected_icon_color":{},"--ov_disabled_icon_color":{},"--ov_hover_color":{},"--ov_hover_text_color":{},"--ov_logo_text_color":{},"--ov_logo_border_color":{},"--ov_toolbar_background_color":{},
"--ov_toolbar_selected_color":{},"--ov_toolbar_separator_color":{},"--ov_treeview_selected_color":{},"--ov_dialog_foreground_color":{},"--ov_dialog_background_color":{},"--ov_border_color":{},"--ov_shadow":{}};var a=document.querySelector(":root");a=window.getComputedStyle(a);for(let b in this.css)Object.prototype.hasOwnProperty.call(this.css,b)&&(this.css[b].light=a.getPropertyValue(b),this.css[b].dark=a.getPropertyValue(b+"_dark"))}SwitchTheme(a){if(a===OV.Theme.Light)a="light";else if(a===OV.Theme.Dark)a=
"dark";else return;let b=document.querySelector(":root");for(let c in this.css)if(Object.prototype.hasOwnProperty.call(this.css,c)){let d=this.css[c][a];void 0!==d&&b.style.setProperty(c,d)}}};OV.WebsiteUIState={Undefined:0,Intro:1,Model:2,Loading:3};
OV.Website=class{constructor(a){this.parameters=a;this.settings=new OV.Settings;this.viewer=new OV.Viewer;this.measureTool=new OV.MeasureTool;this.hashHandler=new OV.HashHandler;this.cookieHandler=new OV.CookieHandler;this.toolbar=new OV.Toolbar(this.parameters.toolbarDiv);this.navigator=new OV.Navigator(this.parameters.navigatorDiv,this.parameters.navigatorSplitterDiv);this.sidebar=new OV.Sidebar(this.parameters.sidebarDiv,this.parameters.sidebarSplitterDiv,this.settings,this.measureTool);this.eventHandler=
new OV.EventHandler(this.parameters.eventHandler);this.modelLoaderUI=new OV.ThreeModelLoaderUI;this.themeHandler=new OV.ThemeHandler;this.highlightColor=new THREE.Color(9357808);this.uiState=OV.WebsiteUIState.Undefined;this.dialog=this.model=null}Load(){this.settings.LoadFromCookies(this.cookieHandler);this.SwitchTheme(this.settings.themeId,!1);this.eventHandler.HandleEvent("theme_on_load",this.settings.themeId===OV.Theme.Light?"light":"dark");this.InitViewer();this.InitMeasureTool();this.InitToolbar();
this.InitDragAndDrop();this.InitSidebar();this.InitNavigator();this.InitCookieConsent();this.viewer.SetMouseClickHandler(this.OnModelClicked.bind(this));this.viewer.SetMouseMoveHandler(this.OnModelMouseMoved.bind(this));this.viewer.SetContextMenuHandler(this.OnModelContextMenu.bind(this));this.Resize();this.SetUIState(OV.WebsiteUIState.Intro);this.hashHandler.SetEventListener(this.OnHashChange.bind(this));this.OnHashChange();OV.AddSmallWidthChangeEventListener(()=>{this.OnSmallWidthChanged()});window.addEventListener("resize",
()=>{this.Resize()})}Resize(){var a=window.innerWidth,b=window.innerHeight;let c=this.parameters.headerDiv.offsetHeight,d=0,e=0,f=0;OV.IsSmallWidth()||(d=this.navigator.GetWidth(),e=this.sidebar.GetWidth(),f=1);a=a-d-e;50>a&&(this.sidebar.DecreaseWidth(50-a),a=50);b-=c;OV.SetDomElementOuterHeight(this.parameters.introDiv,b);this.navigator.Resize(b);this.sidebar.Resize(b);this.viewer.Resize(a-f,b)}OnSmallWidthChanged(){this.uiState===OV.WebsiteUIState.Model&&this.UpdatePanelsVisibility()}HasLoadedModel(){return null!==
this.model}SetUIState(a){function b(c){document.querySelector(":root").style.setProperty("--ov_only_on_model_display",c?"inherit":"none")}this.uiState!==a&&(this.uiState=a,this.uiState===OV.WebsiteUIState.Intro?(OV.ShowDomElement(this.parameters.introDiv,!0),OV.ShowDomElement(this.parameters.mainDiv,!1),b(!1)):this.uiState===OV.WebsiteUIState.Model?(OV.ShowDomElement(this.parameters.introDiv,!1),OV.ShowDomElement(this.parameters.mainDiv,!0),b(!0),this.UpdatePanelsVisibility()):this.uiState===OV.WebsiteUIState.Loading&&
(OV.ShowDomElement(this.parameters.introDiv,!1),OV.ShowDomElement(this.parameters.mainDiv,!1),b(!1)),this.Resize())}ClearModel(){this.HidePopups();this.model=null;this.viewer.Clear();this.parameters.fileNameDiv.innerHTML="";this.navigator.Clear();this.sidebar.Clear();this.measureTool.Clear();this.sidebar.UpdateMeasureTool()}OnModelLoaded(a,b){this.model=a.model;this.parameters.fileNameDiv.innerHTML=a.mainFile;this.viewer.SetMainObject(b);this.viewer.SetUpVector(a.upVector,!1);this.navigator.FillTree(a);
this.UpdateSidebar();this.FitModelToWindow(!0)}OnModelClicked(a,b){1===a&&(this.measureTool.IsActive()?(this.measureTool.Click(b),this.sidebar.UpdateMeasureTool()):(a=this.viewer.GetMeshUserDataUnderMouse(b),null===a?this.navigator.SetSelection(null):this.navigator.SetSelection(new OV.Selection(OV.SelectionType.Mesh,a.originalMeshId))))}OnModelMouseMoved(a){}OnModelContextMenu(a,b){let c=this.viewer.GetMeshUserDataUnderMouse(b),d=[];if(null===c)d.push({name:"Fit model to window",icon:"fit",onClick:()=>
{this.FitModelToWindow(!1)}}),this.navigator.HasHiddenMesh()&&d.push({name:"Show all meshes",icon:"visible",onClick:()=>{this.navigator.ShowAllMeshes(!0)}});else if(d.push({name:"Hide mesh",icon:"hidden",onClick:()=>{this.navigator.ToggleMeshVisibility(c.originalMeshId)}}),d.push({name:"Fit mesh to window",icon:"fit",onClick:()=>{this.navigator.FitMeshToWindow(c.originalMeshId)}}),1<this.navigator.MeshItemCount()){let e=this.navigator.IsMeshIsolated(c.originalMeshId);d.push({name:e?"Remove isolation":
"Isolate mesh",icon:e?"deisolate":"isolate",onClick:()=>{e?this.navigator.ShowAllMeshes(!0):this.navigator.IsolateMesh(c.originalMeshId)}})}this.dialog=OV.ShowListPopup(d,{calculatePosition:e=>OV.CalculatePopupPositionToScreen(a,e),onClick:e=>{d[e].onClick()}})}OnHashChange(){if(this.hashHandler.HasHash()){let c=this.hashHandler.GetModelFilesFromHash();if(null!==c){OV.TransformFileHostUrls(c);var a=new OV.ImportSettings;a.defaultColor=this.settings.defaultColor;var b=this.hashHandler.GetDefaultColorFromHash();
null!==b&&(a.defaultColor=b);this.eventHandler.HandleEvent("model_load_started","hash");this.LoadModelFromUrlList(c,a)}}else this.ClearModel(),this.SetUIState(OV.WebsiteUIState.Intro)}HidePopups(){null!==this.dialog&&(this.dialog.Hide(),this.dialog=null)}OpenFileBrowserDialog(){this.parameters.fileInput.click()}FitModelToWindow(a){let b=!a,c=this.viewer.GetBoundingSphere(d=>this.navigator.IsMeshVisible(d.originalMeshId));a&&this.viewer.AdjustClippingPlanesToSphere(c);this.viewer.FitSphereToWindow(c,
b)}FitMeshToWindow(a){let b=this.viewer.GetBoundingSphere(c=>c.originalMeshId.IsEqual(a));this.viewer.FitSphereToWindow(b,!0)}FitMeshesToWindow(a){let b=new Set;for(let c of a)b.add(c.GetKey());a=this.viewer.GetBoundingSphere(c=>b.has(c.originalMeshId.GetKey()));this.viewer.FitSphereToWindow(a,!0)}UpdateSidebar(){let a=OV.HasDefaultMaterial(this.model);this.sidebar.UpdateSettings(a)}UpdateMeshesVisibility(){this.viewer.SetMeshesVisibility(a=>this.navigator.IsMeshVisible(a.originalMeshId))}UpdateMeshesSelection(){let a=
this.navigator.GetSelectedMeshId();this.viewer.SetMeshesHighlight(this.highlightColor,b=>null!==a&&b.originalMeshId.IsEqual(a)?!0:!1)}LoadModelFromUrlList(a,b){this.LoadModel(a,OV.FileSource.Url,b);this.ClearHashIfNotOnlyUrlList()}LoadModelFromFileList(a){let b=new OV.ImportSettings;b.defaultColor=this.settings.defaultColor;this.LoadModel(a,OV.FileSource.File,b);this.ClearHashIfNotOnlyUrlList()}LoadModel(a,b,c){this.modelLoaderUI.LoadModel(a,b,c,{onStart:()=>{this.SetUIState(OV.WebsiteUIState.Loading);
this.ClearModel()},onFinish:(d,e)=>{this.SetUIState(OV.WebsiteUIState.Model);this.OnModelLoaded(d,e);d=OV.GetFileExtension(d.mainFile);this.eventHandler.HandleEvent("model_loaded",d)},onRender:()=>{this.viewer.Render()},onError:d=>{this.SetUIState(OV.WebsiteUIState.Intro);var e=[];let f=this.modelLoaderUI.GetImporter().GetFileList().GetFiles();for(let g=0;g<f.length;g++)e.push(f[g].extension);e=e.join(",");d.code===OV.ImportErrorCode.NoImportableFile?this.eventHandler.HandleEvent("no_importable_file",
e):d.code===OV.ImportErrorCode.FailedToLoadFile?this.eventHandler.HandleEvent("failed_to_load_file",e):d.code===OV.ImportErrorCode.ImportFailed&&this.eventHandler.HandleEvent("import_failed",e)}})}ClearHashIfNotOnlyUrlList(){!this.modelLoaderUI.GetImporter().GetFileList().IsOnlyUrlSource()&&this.hashHandler.HasHash()&&(this.hashHandler.SkipNextEventHandler(),this.hashHandler.ClearHash())}UpdateGridDisplay(){this.settings.SaveToCookies(this.cookieHandler);this.viewer.SetGridSettings(this.settings.showGrid)}UpdateEdgeDisplay(){this.settings.SaveToCookies(this.cookieHandler);
this.viewer.SetEdgeSettings(this.settings.showEdges,this.settings.edgeColor,this.settings.edgeThreshold)}SwitchTheme(a,b){this.settings.themeId=a;this.themeHandler.SwitchTheme(this.settings.themeId);this.settings.SaveToCookies(this.cookieHandler);b&&(this.settings.SaveToCookies(this.cookieHandler),this.viewer.SetBackgroundColor(this.settings.backgroundColor),a=this.modelLoaderUI.GetModelLoader(),null!==a.GetDefaultMaterial()&&(OV.ReplaceDefaultMaterialColor(this.model,this.settings.defaultColor),
a.ReplaceDefaultMaterialColor(this.settings.defaultColor)))}InitViewer(){let a=OV.AddDomElement(this.parameters.viewerDiv,"canvas");this.viewer.Init(a);this.viewer.SetGridSettings(this.settings.showGrid);this.viewer.SetEdgeSettings(this.settings.showEdges,this.settings.edgeColor,this.settings.edgeThreshold);this.viewer.SetBackgroundColor(this.settings.backgroundColor);this.viewer.SetEnvironmentMap("assets/envmaps/grayclouds/posx.jpg assets/envmaps/grayclouds/negx.jpg assets/envmaps/grayclouds/posy.jpg assets/envmaps/grayclouds/negy.jpg assets/envmaps/grayclouds/posz.jpg assets/envmaps/grayclouds/negz.jpg".split(" "))}InitMeasureTool(){this.measureTool.Init(this.viewer,
this.highlightColor)}InitToolbar(){function a(d,e,f,g,h){d=d.AddImageButton(e,f,()=>{h()});for(let l of g)d.AddClass(l);return d}function b(d,e){d=d.AddSeparator();if(null!==e)for(let f of e)d.classList.add(f)}let c=this.modelLoaderUI.GetImporter();a(this.toolbar,"open","Open model from your device",[],()=>{this.OpenFileBrowserDialog()});a(this.toolbar,"open_url","Open model from a url",[],()=>{this.dialog=OV.ShowOpenUrlDialog(d=>{0<d.length&&this.hashHandler.SetModelFilesToHash(d)})});b(this.toolbar,
["only_on_model"]);a(this.toolbar,"fit","Fit model to window",["only_on_model"],()=>{this.FitModelToWindow(!1)});a(this.toolbar,"up_y","Set Y axis as up vector",["only_on_model"],()=>{this.viewer.SetUpVector(OV.Direction.Y,!0)});a(this.toolbar,"up_z","Set Z axis as up vector",["only_on_model"],()=>{this.viewer.SetUpVector(OV.Direction.Z,!0)});a(this.toolbar,"flip","Flip up vector",["only_on_model"],()=>{this.viewer.FlipUpVector()});b(this.toolbar,["only_on_model"]);(function(d,e,f,g,h,l){let n=[];
for(let m=0;m<e.length;m++)n.push({image:e[m],title:f[m]});d=d.AddImageRadioButton(n,g,m=>{l(m)});for(let m of h)for(let k of d)k.AddClass(m)})(this.toolbar,["fix_up_on","fix_up_off"],["Fixed up vector","Free orbit"],0,["only_on_model"],d=>{0===d?this.viewer.SetFixUpVector(!0):1===d&&this.viewer.SetFixUpVector(!1)});b(this.toolbar,["only_full_width","only_on_model"]);a(this.toolbar,"export","Export model",["only_full_width","only_on_model"],()=>{(new OV.ExportDialog({isMeshVisible:d=>this.navigator.IsMeshVisible(d),
onDialog:d=>{this.dialog=d}},this.eventHandler)).Show(this.model,this.viewer)});a(this.toolbar,"share","Share model",["only_full_width","only_on_model"],()=>{this.dialog=OV.ShowSharingDialog(c.GetFileList(),this.settings,this.viewer.GetCamera(),this.eventHandler)});this.parameters.fileInput.addEventListener("change",d=>{0<d.target.files.length&&(this.eventHandler.HandleEvent("model_load_started","open_file"),this.LoadModelFromFileList(d.target.files))})}InitDragAndDrop(){window.addEventListener("dragstart",
a=>{a.preventDefault()},!1);window.addEventListener("dragover",a=>{a.stopPropagation();a.preventDefault();a.dataTransfer.dropEffect="copy"},!1);window.addEventListener("drop",a=>{a.stopPropagation();a.preventDefault();OV.GetFilesFromDataTransfer(a.dataTransfer,b=>{0<b.length&&(this.eventHandler.HandleEvent("model_load_started","drop"),this.LoadModelFromFileList(b))})},!1)}InitSidebar(){this.sidebar.Init({onBackgroundColorChange:()=>{this.settings.SaveToCookies(this.cookieHandler);this.viewer.SetBackgroundColor(this.settings.backgroundColor)},
onDefaultColorChange:()=>{this.settings.SaveToCookies(this.cookieHandler);let a=this.modelLoaderUI.GetModelLoader();null!==a.GetDefaultMaterial()&&(OV.ReplaceDefaultMaterialColor(this.model,this.settings.defaultColor),a.ReplaceDefaultMaterialColor(this.settings.defaultColor));this.viewer.Render()},onGridDisplayChange:()=>{this.UpdateGridDisplay()},onEdgeDisplayChange:()=>{this.eventHandler.HandleEvent("edge_display_changed",this.settings.showEdges?"on":"off");this.UpdateEdgeDisplay()},onThemeChange:()=>
{this.eventHandler.HandleEvent("theme_changed",this.settings.themeId===OV.Theme.Light?"light":"dark");this.SwitchTheme(this.settings.themeId,!0)},onMeasureToolActivedChange:a=>{a?(this.navigator.SetSelection(null),this.measureTool.SetActive(!0)):this.measureTool.SetActive(!1);this.sidebar.UpdateMeasureTool()},onResize:()=>{this.Resize()},onShowHidePanels:a=>{this.cookieHandler.SetBoolVal("ov_show_sidebar",a)}})}InitNavigator(){function a(e,f){let g=null;e.EnumerateMeshesUserData(h=>{h.originalMeshId.IsEqual(f)&&
(g=h)});return g}function b(e,f,g){let h=[];e.EnumerateMeshesUserData(l=>{if(null===g||-1!==l.originalMaterials.indexOf(g)){const n=f.GetMesh(l.originalMeshId.meshIndex);h.push({meshId:l.originalMeshId,name:n.GetName()})}});return h}function c(e,f){e=e.GetMaterial(f);return{index:f,name:e.name,color:e.color.Clone()}}function d(e,f,g){let h=[];if(null===g)for(e=0;e<f.MaterialCount();e++)h.push(c(f,e));else for(e=a(e,g),g=0;g<e.originalMaterials.length;g++)h.push(c(f,e.originalMaterials[g]));h.sort((l,
n)=>l.index-n.index);return h}this.navigator.Init({openFileBrowserDialog:()=>{this.OpenFileBrowserDialog()},updateMeshesVisibility:()=>{this.UpdateMeshesVisibility()},updateMeshesSelection:()=>{this.UpdateMeshesSelection()},fitMeshToWindow:e=>{this.FitMeshToWindow(e)},fitMeshesToWindow:e=>{this.FitMeshesToWindow(e)},getMeshesForMaterial:e=>b(this.viewer,this.model,e),getMaterialsForMesh:e=>d(this.viewer,this.model,e),onModelSelected:()=>{this.sidebar.AddObject3DProperties(this.model)},onMeshSelected:e=>
{e=this.model.GetMeshInstance(e);this.sidebar.AddObject3DProperties(e)},onMaterialSelected:e=>{this.sidebar.AddMaterialProperties(this.model.GetMaterial(e))},onResize:()=>{this.Resize()},onShowHidePanels:e=>{this.cookieHandler.SetBoolVal("ov_show_navigator",e)}})}UpdatePanelsVisibility(){let a=this.cookieHandler.GetBoolVal("ov_show_navigator",!0),b=this.cookieHandler.GetBoolVal("ov_show_sidebar",!0);this.navigator.ShowPanels(a);this.sidebar.ShowPanels(b)}InitCookieConsent(){if(!this.cookieHandler.GetBoolVal("ov_cookie_consent",
!1)){var a=OV.AddDiv(document.body,"ov_bottom_floating_panel");}}};OV.Embed=class{constructor(a){this.parameters=a;this.viewer=new OV.Viewer;this.hashHandler=new OV.HashHandler;this.modelLoaderUI=new OV.ThreeModelLoaderUI}Load(){var a=OV.AddDomElement(this.parameters.viewerDiv,"canvas");this.InitViewer(a);this.Resize();if(this.hashHandler.HasHash()){a=this.hashHandler.GetModelFilesFromHash();if(null===a)return;OV.TransformFileHostUrls(a);var b=this.hashHandler.GetBackgroundFromHash();null!==b&&this.viewer.SetBackgroundColor(b);b=this.hashHandler.GetEdgeSettingsFromHash();
null!==b&&this.viewer.SetEdgeSettings(b.showEdges,b.edgeColor,b.edgeThreshold);b=new OV.ImportSettings;let c=this.hashHandler.GetDefaultColorFromHash();null!==c&&(b.defaultColor=c);this.modelLoaderUI.LoadModel(a,OV.FileSource.Url,b,{onStart:()=>{},onFinish:(d,e)=>{this.OnModelFinished(d,e)},onRender:()=>{this.viewer.Render()},onError:d=>{}});a=OV.CreateModelUrlParameters(a);a=this.parameters.websiteLinkDiv.getAttribute("href")+"#"+a;this.parameters.websiteLinkDiv.setAttribute("href",a)}window.addEventListener("resize",
()=>{this.Resize()})}Resize(){this.viewer.Resize(window.innerWidth,window.innerHeight)}OnModelFinished(a,b){this.viewer.SetMainObject(b);b=this.viewer.GetBoundingSphere(d=>!0);this.viewer.AdjustClippingPlanesToSphere(b);let c=this.hashHandler.GetCameraFromHash();null!==c?this.viewer.SetCamera(c):this.viewer.SetUpVector(a.upVector,!1);this.viewer.FitSphereToWindow(b,!1)}InitViewer(a){this.viewer.Init(a);this.viewer.SetEnvironmentMap("assets/envmaps/grayclouds/posx.jpg assets/envmaps/grayclouds/negx.jpg assets/envmaps/grayclouds/posy.jpg assets/envmaps/grayclouds/negy.jpg assets/envmaps/grayclouds/posz.jpg assets/envmaps/grayclouds/negz.jpg".split(" "))}};
